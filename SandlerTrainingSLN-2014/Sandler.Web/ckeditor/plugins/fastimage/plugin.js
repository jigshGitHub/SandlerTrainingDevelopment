(function(){function a(c,b,g,f,e){var d;if(window.XMLHttpRequest){d=new XMLHttpRequest();}else{d=new ActiveXObject("Microsoft.XMLHTTP");}d.onreadystatechange=(function(){var h=c;return function(){if(d.readyState==4){if(d.status==200){f(c,d.responseText);}else{e(c,d.responseText);}}};})();d.open("POST",b,true);d.send(g);}CKEDITOR.plugins.add("fastimage",{lang:["en"],init:function(b){b.addCommand("fastimage",{exec:function(d){var e=document.getElementById("fastimageForm");if(e!=null){e.parentNode.removeChild(e);}e=document.createElement("div");e.id="fastimageForm";e.setAttribute("style","display:none");e.innerHTML='<form enctype="multipart/form-data"><input type="file" name="files" multiple="multiple" id="fastimageFile"><input type="submit" id="fastimageSubmit"></form>';document.getElementsByTagName("body")[0].appendChild(e);var c=document.getElementById("fastimageFile");c.addEventListener("change",(function(){var f=c;var h=d;var g=d.config.fastimage_url;return function(){var k=f.files;var l=new FormData();for(var j=0;j<k.length;j++){l.append("file_"+j,k[j]);}a(h,g,l,function(n,m){var i=CKEDITOR.dom.element.createFromHtml(m);n.insertElement(i);},function(m,i){alert(m.lang["fastimage"]["fail"]+": "+i);});};})());c.click();}});if(!b.config.fastimage_url){b.config.fastimage_url=this.path+"u.php";}b.ui.addButton("fastimage",{label:b.lang["fastimage"]["tooltip"],icon:this.path+"fastimage.png",command:"fastimage"});}});})();